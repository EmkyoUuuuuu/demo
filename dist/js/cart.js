"use strict";function asyncGeneratorStep(e,t,n,a,r,o,c){try{var i=e[o](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(a,r)}function _asyncToGenerator(i){return function(){var e=this,c=arguments;return new Promise(function(t,n){var a=i.apply(e,c);function r(e){asyncGeneratorStep(a,t,n,r,o,"next",e)}function o(e){asyncGeneratorStep(a,t,n,r,o,"throw",e)}r(void 0)})}}var id=window.localStorage.getItem("id"),token=window.localStorage.getItem("token");function getCarList(){return _getCarList.apply(this,arguments)}function _getCarList(){return(_getCarList=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.ajax({url:"http://localhost:8888/cart/list",data:{id:id},headers:{authorization:token}});case 2:if(401===(t=e.sent).code)return alert("请登陆后查看您的购物车，谢谢合作"),e.abrupt("return");e.next=6;break;case 6:1===t.code&&(console.log(t),t.cart.length?(n="",t.cart.forEach(function(e){n+='\n                <p>\n                <img src="'.concat(e.img_small_logo,'" alt="">\n                <span class="title">描述:').concat(e.title,'</span>\n                <span class="price">价格:').concat(e.price,"</span>\n                </p>\n                ")}),$(".container").html(n),$(".clear").css("display","block")):($(".info").html('购物车空空如也,点击<a href="./index.html">首页</a>Go Shopping吧!'),$(".clear").css("display","none")));case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}id||($(".on").addClass("active"),$(".off").removeClass("active")),$.ajax({url:"http://localhost:8888/users/info?id="+id,headers:{authorization:token},success:function(e){1!==e.code?($(".on").addClass("active"),$(".off").removeClass("active")):($(".nickname").html(e.info.nickname),$(".on").removeClass("active"),$(".off").addClass("active"))}}),$(".logout").on("click",_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.ajax({url:"http://localhost:8888/users/logout",data:{id:id}});case 2:1===e.sent.code&&(window.localStorage.removeItem("id"),window.localStorage.removeItem("token"),window.location.replace("./login.html"));case 4:case"end":return e.stop()}},e)}))),getCarList(),$(".clear").on("click",function(){function e(){return(e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.ajax({url:"http://localhost:8888/cart/clear",data:{id:id},headers:{authorization:token}});case 2:if(401===(t=e.sent).code)return alert("请先登录"),window.location.href="./login.html",e.abrupt("return");e.next=7;break;case 7:1===t.code&&(alert("清空购物车成功"),window.location.reload());case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()});